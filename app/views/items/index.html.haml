%p#notice= notice
%h1 Listing Items
%table.table.table-striped
  %thead
    %tr
      %th
        = sort_link @search, :title, "Title"
      -#%th
        -#= sort_link @search, :barcode, "Barcode"
      %th
        = sort_link @search, :category_id, "Category"
      %th
        = sort_link @search, :publisher, "Publisher"
      %th
        = sort_link @search, :year, "Year"
      %th Available
      - if admin_signed_in?
        %th{:colspan => "3"}
  %tbody
    = search_form_for @search,:builder => SimpleForm::FormBuilder do |f|
      = f.input :title_cont,:label => "Title"
      -#= f.input :barcode_cont,:label => "Barcode"
      = f.input :category_search, collection: Category.all.map {|v| v.to_label}, label: "Category: ", required: false,
            include_blank: true
      = f.submit "Search",class: "btn btn-info search"
    - @items.group("barcode", "items.id").each do |item|
      %tr
        %td= item.title
        -#%td= item.barcode
        %td
          = item.category.name.humanize unless item.category.nil?
        %td= item.publisher
        %td= item.year
        %td
          -if item.total_available == 0 && user_active?
            %td= button_to 'Request this item', "#", class: "btn btn-primary btn-sm", method: :get
          -else
            = item.total_available
        - if admin_signed_in?
          %td= button_to 'Show', item, class: "btn btn-primary btn-sm", method: :get
          %td= button_to 'Edit', edit_item_path(item), class: "btn btn-success btn-sm", method: :get
          %td= button_to 'Delete', item, method: :delete, data: { confirm: 'Are you sure?' },:class=>"btn btn-danger btn-sm"
= will_paginate @items
%br/
- if admin_signed_in?
  = link_to 'New Item', new_item_path, { :class=>"btn btn-success btn-lg" }

:javascript
    $("#q_category_search").select2({allowClear: true, dropdownAutoWidth : true, width: 'resolve'});
